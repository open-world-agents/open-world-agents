
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Everything you need to build state-of-the-art foundation multimodal desktop agent, end-to-end.">
      
      
      
      
        <link rel="prev" href="../how_to_explorer_and_edit/">
      
      
        <link rel="next" href="../owa_data_pipeline/">
      
      
      <link rel="icon" href="../../images/owa-logo.jpg">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.14">
    
    
      
        <title>OWAMcap Format Guide - Open World Agents</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.342714a4.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../termynal.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#owamcap-format-guide" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Open World Agents" class="md-header__button md-logo" aria-label="Open World Agents" data-md-component="logo">
      
  <img src="../../images/owa-logo.jpg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Open World Agents
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OWAMcap Format Guide
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="purple"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 6H7c-3.31 0-6 2.69-6 6s2.69 6 6 6h10c3.31 0 6-2.69 6-6s-2.69-6-6-6m0 10H7c-2.21 0-4-1.79-4-4s1.79-4 4-4h10c2.21 0 4 1.79 4 4s-1.79 4-4 4M7 9c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="teal" data-md-color-accent="lime"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/open-world-agents/open-world-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    open-world-agents
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Open World Agents" class="md-nav__button md-logo" aria-label="Open World Agents" data-md-component="logo">
      
  <img src="../../images/owa-logo.jpg" alt="logo">

    </a>
    Open World Agents
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/open-world-agents/open-world-agents" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    open-world-agents
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
        
          
          <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Get Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_1">
            <span class="md-nav__icon md-icon"></span>
            Get Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Welcome to OWA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../help_with_owa/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Help with OWA
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Installation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Contributing
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Env in OWA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Env in OWA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducing OWA's Env
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comprehensive Guide for Env
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/custom_plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Custom EnvPlugins
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/documentation_validation/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation Validation
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/documentation_quick_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Documentation Quick Reference
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_6" >
        
          
          <label class="md-nav__link" for="__nav_2_6" id="__nav_2_6_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Lists of EnvPlugins
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_6">
            <span class="md-nav__icon md-icon"></span>
            Lists of EnvPlugins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/plugins/std/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Standard Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/plugins/desktop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Desktop Environment
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../env/plugins/gst/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Gstreamer Environment
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    Data in OWA
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Data in OWA
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_2" >
        
          
          <label class="md-nav__link" for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Getting Started
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Getting Started
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../why_owamcap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Why OWAMcap?
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ocap/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Recording Data
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../how_to_explorer_and_edit/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Exploring Data
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_3" checked>
        
          
          <label class="md-nav__link" for="__nav_3_3" id="__nav_3_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Technical Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_3_3">
            <span class="md-nav__icon md-icon"></span>
            Technical Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    OWAMcap Format Guide
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    OWAMcap Format Guide
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-terms" class="md-nav__link">
    <span class="md-ellipsis">
      Key Terms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-makes-a-file-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      What Makes a File "OWAMcap"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      Core Message Types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      Working with OWAMcap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with OWAMcap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#media-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Media Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-and-writing" class="md-nav__link">
    <span class="md-ellipsis">
      Reading and Writing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Storage &amp; Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage &amp; Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compression-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Compression Benefits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Message Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Message Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-custom-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Custom Messages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-registration" class="md-nav__link">
    <span class="md-ellipsis">
      Package Registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-with-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      Usage with OWAMcap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-integration" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integration-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Migration &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-migration" class="md-nav__link">
    <span class="md-ellipsis">
      File Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Reference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../owa_data_pipeline/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ğŸš€ Data Pipeline (MCAP â†’ VLA Training)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3_4" >
        
          
          <label class="md-nav__link" for="__nav_3_4" id="__nav_3_4_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Tools & Comparison
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_4">
            <span class="md-nav__icon md-icon"></span>
            Tools & Comparison
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../viewer/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Data Viewer
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../comparison_with_lerobot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Comparison with LeRobot
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    CLI Tools
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            CLI Tools
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../owl_cli_reference/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    OWL CLI Reference
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="">
            
  
  
  <span class="md-ellipsis">
    ğŸš€ Awesome Examples (WIP)
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            ğŸš€ Awesome Examples (WIP)
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/multimodal_game_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Multimodal Game Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/gui_agent/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Omniparse + InternLM GUI Agent
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/interactive_world_model/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interactve World Model
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/usage_with_transformers/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage with transformers
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../examples/usage_with_llm/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usage with LLM Inference Engines(ollama, ...)
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#table-of-contents" class="md-nav__link">
    <span class="md-ellipsis">
      Table of Contents
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quick-start" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Start
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Core Concepts
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Concepts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#key-terms" class="md-nav__link">
    <span class="md-ellipsis">
      Key Terms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#what-makes-a-file-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      What Makes a File "OWAMcap"
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-features" class="md-nav__link">
    <span class="md-ellipsis">
      Key Features
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      Core Message Types
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#working-with-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      Working with OWAMcap
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Working with OWAMcap">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#media-handling" class="md-nav__link">
    <span class="md-ellipsis">
      Media Handling
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reading-and-writing" class="md-nav__link">
    <span class="md-ellipsis">
      Reading and Writing
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#storage-performance" class="md-nav__link">
    <span class="md-ellipsis">
      Storage &amp; Performance
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Storage &amp; Performance">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#compression-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      Compression Benefits
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#custom-message-types" class="md-nav__link">
    <span class="md-ellipsis">
      Custom Message Types
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Custom Message Types">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#creating-custom-messages" class="md-nav__link">
    <span class="md-ellipsis">
      Creating Custom Messages
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#package-registration" class="md-nav__link">
    <span class="md-ellipsis">
      Package Registration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#usage-with-owamcap" class="md-nav__link">
    <span class="md-ellipsis">
      Usage with OWAMcap
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cli-integration" class="md-nav__link">
    <span class="md-ellipsis">
      CLI Integration
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#advanced-usage" class="md-nav__link">
    <span class="md-ellipsis">
      Advanced Usage
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Advanced Usage">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#integration-examples" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Examples
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices_1" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#migration-troubleshooting" class="md-nav__link">
    <span class="md-ellipsis">
      Migration &amp; Troubleshooting
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Migration &amp; Troubleshooting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#file-migration" class="md-nav__link">
    <span class="md-ellipsis">
      File Migration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Technical Reference
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technical Reference">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      Quick Reference
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#next-steps" class="md-nav__link">
    <span class="md-ellipsis">
      Next Steps
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="owamcap-format-guide">OWAMcap Format Guide<a class="headerlink" href="#owamcap-format-guide" title="Permanent link">&para;</a></h1>
<div class="admonition info">
<p class="admonition-title">What is OWAMcap?</p>
<p>OWAMcap is a specification for using the open-source <a href="https://mcap.dev/">MCAP</a> container format with Open World Agents (OWA) message definitions. It provides an efficient way to store and process multimodal desktop interaction data including screen captures, mouse events, keyboard events, and window information.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">New to OWAMcap?</p>
<p>Start with <strong><a href="../why_owamcap/">Why OWAMcap?</a></strong> to understand the problem it solves and why you should use it.</p>
</div>
<h2 id="table-of-contents">Table of Contents<a class="headerlink" href="#table-of-contents" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="#quick-start">Quick Start</a> - Get started in 3 steps</li>
<li><a href="#core-concepts">Core Concepts</a> - Essential message types and features</li>
<li><a href="#working-with-owamcap">Working with OWAMcap</a> - Reading, writing, and media handling</li>
<li><a href="#storage--performance">Storage &amp; Performance</a> - Efficiency characteristics</li>
<li><a href="#custom-message-types">Custom Message Types</a> - Extend OWAMcap with your own message types</li>
<li><a href="#advanced-usage">Advanced Usage</a> - Integrations and best practices</li>
<li><a href="#migration--troubleshooting">Migration &amp; Troubleshooting</a> - Practical help</li>
<li><a href="#technical-reference">Technical Reference</a> - Specifications and standards</li>
</ul>
<h2 id="quick-start">Quick Start<a class="headerlink" href="#quick-start" title="Permanent link">&para;</a></h2>
<div class="admonition example">
<p class="admonition-title">Try OWAMcap in 3 Steps</p>
<p><strong>1. Install the packages:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>pip<span class="w"> </span>install<span class="w"> </span>mcap-owa-support<span class="w"> </span>owa-msgs
</code></pre></div></p>
<p><strong>2. Explore an example file with the <code>owl</code> CLI:</strong></p>
<div class="admonition info">
<p class="admonition-title">What is <code>owl</code>?</p>
<p><code>owl</code> is the command-line interface for OWA tools, installed with <code>owa-cli</code>. See the <a href="../../owl_cli_reference/">CLI documentation</a> for complete usage.</p>
</div>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="c1"># Download example file</span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a>wget<span class="w"> </span>https://github.com/open-world-agents/open-world-agents/raw/main/docs/data/example.mcap
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="c1"># View file info</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a>owl<span class="w"> </span>mcap<span class="w"> </span>info<span class="w"> </span>example.mcap
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="c1"># List first 5 messages</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>owl<span class="w"> </span>mcap<span class="w"> </span>cat<span class="w"> </span>example.mcap<span class="w"> </span>--n<span class="w"> </span><span class="m">5</span>
</code></pre></div>
<p><strong>3. Load in Python:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcap_owa.highlevel</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMcapReader</span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;example.mcap&quot;</span><span class="p">,</span> <span class="n">decode_args</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;return_dict&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a>        <span class="n">screen_data</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame: </span><span class="si">{</span><span class="n">screen_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">screen_data</span><span class="o">.</span><span class="n">utc_ns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a>        <span class="k">break</span>  <span class="c1"># Just show first frame</span>
</code></pre></div></p>
</div>
<h2 id="core-concepts">Core Concepts<a class="headerlink" href="#core-concepts" title="Permanent link">&para;</a></h2>
<p>OWAMcap combines the robustness of the MCAP container format with OWA's specialized message types for desktop environments, creating a powerful format for recording, analyzing, and training on human-computer interaction data.</p>
<h3 id="key-terms">Key Terms<a class="headerlink" href="#key-terms" title="Permanent link">&para;</a></h3>
<div class="admonition info">
<p class="admonition-title">Essential Terminology</p>
<ul>
<li><strong>MCAP</strong>: A modular container file format for heterogeneous, timestamped data (like a ZIP file for time-series data)</li>
<li><strong>Topic</strong>: A named channel in MCAP files (e.g., "screen", "mouse") that groups related messages</li>
<li><strong>Lazy Loading</strong>: Loading data only when needed, crucial for memory efficiency with large datasets</li>
</ul>
</div>
<h3 id="what-makes-a-file-owamcap">What Makes a File "OWAMcap"<a class="headerlink" href="#what-makes-a-file-owamcap" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:3"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Technical Definition</label><label for="__tabbed_1_2">Architecture Overview</label><label for="__tabbed_1_3">Practical Example</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li><strong>Base Format</strong>: Standard MCAP container format</li>
<li><strong>Profile</strong>: <code>owa</code> designation in MCAP metadata</li>
<li><strong>Schema Encoding</strong>: JSON Schema</li>
<li><strong>Message Interface</strong>: All messages implement <code>BaseMessage</code> from <code>owa.core.message</code></li>
<li><strong>Standard Messages</strong>: Core message types from <code>owa-msgs</code> package</li>
</ul>
<p><strong>Why MCAP?</strong> Efficient storage and retrieval for heterogeneous timestamped data with minimal dependencies. This is format after ROSBag, but designed for modern use cases and optimized for random access.</p>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a>â”‚                    OWAMcap File (.mcap)                     â”‚
<a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
<a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>â”‚  â”‚   Metadata      â”‚  â”‚   Timestamps    â”‚  â”‚  Messages   â”‚  â”‚
<a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a>â”‚  â”‚   - Profile     â”‚  â”‚   - Nanosecond  â”‚  â”‚  - Mouse    â”‚  â”‚
<a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a>â”‚  â”‚   - Topics      â”‚  â”‚     precision   â”‚  â”‚  - Keyboard â”‚  â”‚
<a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a>â”‚  â”‚   - Schemas     â”‚  â”‚   - Event sync  â”‚  â”‚  - Window   â”‚  â”‚
<a id="__codelineno-3-8" name="__codelineno-3-8" href="#__codelineno-3-8"></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
<a id="__codelineno-3-9" name="__codelineno-3-9" href="#__codelineno-3-9"></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
<a id="__codelineno-3-10" name="__codelineno-3-10" href="#__codelineno-3-10"></a>                                â”‚
<a id="__codelineno-3-11" name="__codelineno-3-11" href="#__codelineno-3-11"></a>                                â”‚ References
<a id="__codelineno-3-12" name="__codelineno-3-12" href="#__codelineno-3-12"></a>                                â–¼
<a id="__codelineno-3-13" name="__codelineno-3-13" href="#__codelineno-3-13"></a>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
<a id="__codelineno-3-14" name="__codelineno-3-14" href="#__codelineno-3-14"></a>â”‚                External Media Files (.mkv, .png)           â”‚
<a id="__codelineno-3-15" name="__codelineno-3-15" href="#__codelineno-3-15"></a>â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
<a id="__codelineno-3-16" name="__codelineno-3-16" href="#__codelineno-3-16"></a>â”‚  â”‚  Video Frames   â”‚  â”‚  Screenshots    â”‚  â”‚   Audio     â”‚  â”‚
<a id="__codelineno-3-17" name="__codelineno-3-17" href="#__codelineno-3-17"></a>â”‚  â”‚  - H.265 codec  â”‚  â”‚  - PNG/JPEG     â”‚  â”‚  - Optional â”‚  â”‚
<a id="__codelineno-3-18" name="__codelineno-3-18" href="#__codelineno-3-18"></a>â”‚  â”‚  - Hardware acc â”‚  â”‚  - Lossless     â”‚  â”‚  - Sync&#39;d   â”‚  â”‚
<a id="__codelineno-3-19" name="__codelineno-3-19" href="#__codelineno-3-19"></a>â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
<a id="__codelineno-3-20" name="__codelineno-3-20" href="#__codelineno-3-20"></a>â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a>$<span class="w"> </span>owl<span class="w"> </span>mcap<span class="w"> </span>info<span class="w"> </span>example.mcap
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a>library:<span class="w">   </span>mcap-owa-support<span class="w"> </span><span class="m">0</span>.5.1<span class="p">;</span><span class="w"> </span>mcap<span class="w"> </span><span class="m">1</span>.3.0
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>profile:<span class="w">   </span>owa
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>messages:<span class="w">  </span><span class="m">864</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>duration:<span class="w">  </span><span class="m">10</span>.3574349s
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>start:<span class="w">     </span><span class="m">2025</span>-06-27T18:49:52.129876+09:00<span class="w"> </span><span class="o">(</span><span class="m">1751017792</span>.129876000<span class="o">)</span><span class="w">   </span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>end:<span class="w">       </span><span class="m">2025</span>-06-27T18:50:02.4873109+09:00<span class="w"> </span><span class="o">(</span><span class="m">1751017802</span>.487310900<span class="o">)</span><span class="w">  </span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>compression:
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="w">        </span>zstd:<span class="w"> </span><span class="o">[</span><span class="m">1</span>/1<span class="w"> </span>chunks<span class="o">]</span><span class="w"> </span><span class="o">[</span><span class="m">116</span>.46<span class="w"> </span>KiB/16.61<span class="w"> </span>KiB<span class="w"> </span><span class="o">(</span><span class="m">85</span>.74%<span class="o">)]</span><span class="w"> </span><span class="o">[</span><span class="m">1</span>.60<span class="w"> </span>KiB/sec<span class="o">]</span><span class="w"> </span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>channels:
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="w">        </span><span class="o">(</span><span class="m">1</span><span class="o">)</span><span class="w"> </span>window<span class="w">           </span><span class="m">11</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">1</span>.06<span class="w"> </span>Hz<span class="o">)</span><span class="w">    </span>:<span class="w"> </span>desktop/WindowInfo<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span><span class="w">      </span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="w">        </span><span class="o">(</span><span class="m">2</span><span class="o">)</span><span class="w"> </span>keyboard/state<span class="w">   </span><span class="m">11</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">1</span>.06<span class="w"> </span>Hz<span class="o">)</span><span class="w">    </span>:<span class="w"> </span>desktop/KeyboardState<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span><span class="w">   </span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="w">        </span><span class="o">(</span><span class="m">3</span><span class="o">)</span><span class="w"> </span>mouse/state<span class="w">      </span><span class="m">11</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">1</span>.06<span class="w"> </span>Hz<span class="o">)</span><span class="w">    </span>:<span class="w"> </span>desktop/MouseState<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span><span class="w">      </span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="w">        </span><span class="o">(</span><span class="m">4</span><span class="o">)</span><span class="w"> </span>screen<span class="w">          </span><span class="m">590</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">56</span>.96<span class="w"> </span>Hz<span class="o">)</span><span class="w">   </span>:<span class="w"> </span>desktop/ScreenCaptured<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="w">        </span><span class="o">(</span><span class="m">5</span><span class="o">)</span><span class="w"> </span>mouse<span class="w">           </span><span class="m">209</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">20</span>.18<span class="w"> </span>Hz<span class="o">)</span><span class="w">   </span>:<span class="w"> </span>desktop/MouseEvent<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="w">        </span><span class="o">(</span><span class="m">6</span><span class="o">)</span><span class="w"> </span>keyboard<span class="w">         </span><span class="m">32</span><span class="w"> </span>msgs<span class="w"> </span><span class="o">(</span><span class="m">3</span>.09<span class="w"> </span>Hz<span class="o">)</span><span class="w">    </span>:<span class="w"> </span>desktop/KeyboardEvent<span class="w"> </span><span class="o">[</span>jsonschema<span class="o">]</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a>channels:<span class="w"> </span><span class="m">6</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a>attachments:<span class="w"> </span><span class="m">0</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a>metadata:<span class="w"> </span><span class="m">0</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="key-features">Key Features<a class="headerlink" href="#key-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Efficient Storage</strong>: External video file references keep MCAP files lightweight</li>
<li><strong>Precise Synchronization</strong>: Nanosecond-precision timestamps for perfect event alignment</li>
<li><strong>Multimodal Data</strong>: Unified storage for visual, input, and context data</li>
<li><strong>Standard Format</strong>: Built on the proven MCAP container format</li>
<li><strong>Extensible</strong>: Support for custom message types through entry points</li>
</ul>
<h3 id="core-message-types">Core Message Types<a class="headerlink" href="#core-message-types" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Message Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>desktop/KeyboardEvent</code></td>
<td>Keyboard press/release events</td>
</tr>
<tr>
<td><code>desktop/KeyboardState</code></td>
<td>Current keyboard state</td>
</tr>
<tr>
<td><code>desktop/MouseEvent</code></td>
<td>Mouse movement, clicks, scrolls</td>
</tr>
<tr>
<td><code>desktop/MouseState</code></td>
<td>Current mouse position and buttons</td>
</tr>
<tr>
<td><code>desktop/ScreenCaptured</code></td>
<td>Screen capture frames with timestamps</td>
</tr>
<tr>
<td><code>desktop/WindowInfo</code></td>
<td>Active window information</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="2:6"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><input id="__tabbed_2_4" name="__tabbed_2" type="radio" /><input id="__tabbed_2_5" name="__tabbed_2" type="radio" /><input id="__tabbed_2_6" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">KeyboardEvent</label><label for="__tabbed_2_2">MouseEvent</label><label for="__tabbed_2_3">KeyboardState</label><label for="__tabbed_2_4">MouseState</label><label for="__tabbed_2_5">WindowInfo</label><label for="__tabbed_2_6">ScreenCaptured â­</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeyboardEvent</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-5-2" name="__codelineno-5-2" href="#__codelineno-5-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/KeyboardEvent&quot;</span>
<a id="__codelineno-5-3" name="__codelineno-5-3" href="#__codelineno-5-3"></a>
<a id="__codelineno-5-4" name="__codelineno-5-4" href="#__codelineno-5-4"></a>    <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;press&quot; or &quot;release&quot;</span>
<a id="__codelineno-5-5" name="__codelineno-5-5" href="#__codelineno-5-5"></a>    <span class="n">vk</span><span class="p">:</span> <span class="nb">int</span>         <span class="c1"># Virtual key code (e.g., 65 for &#39;A&#39;)</span>
<a id="__codelineno-5-6" name="__codelineno-5-6" href="#__codelineno-5-6"></a>    <span class="n">timestamp</span><span class="p">:</span> <span class="nb">int</span>  <span class="c1"># Event timestamp</span>
<a id="__codelineno-5-7" name="__codelineno-5-7" href="#__codelineno-5-7"></a>
<a id="__codelineno-5-8" name="__codelineno-5-8" href="#__codelineno-5-8"></a><span class="c1"># Example: User presses the &#39;A&#39; key</span>
<a id="__codelineno-5-9" name="__codelineno-5-9" href="#__codelineno-5-9"></a><span class="n">KeyboardEvent</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;press&quot;</span><span class="p">,</span> <span class="n">vk</span><span class="o">=</span><span class="mi">65</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="mi">1234567890</span><span class="p">)</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">What's VK (Virtual Key Code)?</p>
<p>Operating systems don't directly use the physical keyboard input values (scan codes) but instead use virtualized keys called VKs. OWA's recorder uses VKs to record keyboard-agnostic data. If you're interested in more details, you can refer to the following resources:</p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/inputdev/about-keyboard-input">Keyboard Input Overview, Microsoft</a></li>
<li><a href="https://learn.microsoft.com/en-us/windows/win32/inputdev/virtual-key-codes">Virtual-Key Codes, Microsoft</a></li>
</ul>
</div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MouseEvent</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/MouseEvent&quot;</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a>    <span class="n">event_type</span><span class="p">:</span> <span class="nb">str</span>  <span class="c1"># &quot;move&quot;, &quot;click&quot;, &quot;scroll&quot;, &quot;drag&quot;</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a>    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># Screen X coordinate</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a>    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>          <span class="c1"># Screen Y coordinate</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a>    <span class="n">button</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>    <span class="c1"># &quot;left&quot;, &quot;right&quot;, &quot;middle&quot;</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="c1"># Example: Mouse click at position (100, 200)</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="n">MouseEvent</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">button</span><span class="o">=</span><span class="s2">&quot;left&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">KeyboardState</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-7-2" name="__codelineno-7-2" href="#__codelineno-7-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/KeyboardState&quot;</span>
<a id="__codelineno-7-3" name="__codelineno-7-3" href="#__codelineno-7-3"></a>
<a id="__codelineno-7-4" name="__codelineno-7-4" href="#__codelineno-7-4"></a>    <span class="n">buttons</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>  <span class="c1"># List of currently pressed virtual key codes</span>
<a id="__codelineno-7-5" name="__codelineno-7-5" href="#__codelineno-7-5"></a>
<a id="__codelineno-7-6" name="__codelineno-7-6" href="#__codelineno-7-6"></a><span class="c1"># Example: No keys currently pressed</span>
<a id="__codelineno-7-7" name="__codelineno-7-7" href="#__codelineno-7-7"></a><span class="n">KeyboardState</span><span class="p">(</span><span class="n">buttons</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">MouseState</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/MouseState&quot;</span>
<a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>
<a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>    <span class="n">x</span><span class="p">:</span> <span class="nb">int</span>                    <span class="c1"># Current mouse X coordinate</span>
<a id="__codelineno-8-5" name="__codelineno-8-5" href="#__codelineno-8-5"></a>    <span class="n">y</span><span class="p">:</span> <span class="nb">int</span>                    <span class="c1"># Current mouse Y coordinate</span>
<a id="__codelineno-8-6" name="__codelineno-8-6" href="#__codelineno-8-6"></a>    <span class="n">buttons</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>   <span class="c1"># Currently pressed mouse buttons</span>
<a id="__codelineno-8-7" name="__codelineno-8-7" href="#__codelineno-8-7"></a>
<a id="__codelineno-8-8" name="__codelineno-8-8" href="#__codelineno-8-8"></a><span class="c1"># Example: Mouse at position with no buttons pressed</span>
<a id="__codelineno-8-9" name="__codelineno-8-9" href="#__codelineno-8-9"></a><span class="n">MouseState</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="mi">1594</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">1112</span><span class="p">,</span> <span class="n">buttons</span><span class="o">=</span><span class="p">[])</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">WindowInfo</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/WindowInfo&quot;</span>
<a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a>
<a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a>    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span>              <span class="c1"># Window title text</span>
<a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a>    <span class="n">rect</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>         <span class="c1"># [x, y, width, height]</span>
<a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a>    <span class="n">hWnd</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span>     <span class="c1"># Windows handle (platform-specific)</span>
<a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a>
<a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="c1"># Example: Browser window</span>
<a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="n">WindowInfo</span><span class="p">(</span>
<a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a>    <span class="n">title</span><span class="o">=</span><span class="s2">&quot;GitHub - Open World Agents - Chrome&quot;</span><span class="p">,</span>
<a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a>    <span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">1200</span><span class="p">,</span> <span class="mi">800</span><span class="p">]</span>
<a id="__codelineno-9-12" name="__codelineno-9-12" href="#__codelineno-9-12"></a><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="k">class</span><span class="w"> </span><span class="nc">ScreenCaptured</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;desktop/ScreenCaptured&quot;</span>
<a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a>
<a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a>    <span class="n">utc_ns</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>                    <span class="c1"># System timestamp (nanoseconds)</span>
<a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a>    <span class="n">source_shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># Original (width, height)</span>
<a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a>    <span class="n">shape</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span>         <span class="c1"># Current (width, height)</span>
<a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a>    <span class="n">media_ref</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">MediaRef</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>            <span class="c1"># URI or file path reference</span>
<a id="__codelineno-10-8" name="__codelineno-10-8" href="#__codelineno-10-8"></a>    <span class="n">frame_arr</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>          <span class="c1"># In-memory BGRA array (excluded from JSON)</span>
<a id="__codelineno-10-9" name="__codelineno-10-9" href="#__codelineno-10-9"></a>
<a id="__codelineno-10-10" name="__codelineno-10-10" href="#__codelineno-10-10"></a><span class="c1"># MediaRef supports: URI(data:image/png;base64,... | file:///path | http[s]://...)</span>
<a id="__codelineno-10-11" name="__codelineno-10-11" href="#__codelineno-10-11"></a><span class="c1"># or file path(/absolute/path | relative/path) for both images and videos</span>
<a id="__codelineno-10-12" name="__codelineno-10-12" href="#__codelineno-10-12"></a>
<a id="__codelineno-10-13" name="__codelineno-10-13" href="#__codelineno-10-13"></a><span class="c1"># Creation patterns:</span>
<a id="__codelineno-10-14" name="__codelineno-10-14" href="#__codelineno-10-14"></a><span class="c1"># - From raw image: ScreenCaptured(frame_arr=bgra_array).embed_as_data_uri()</span>
<a id="__codelineno-10-15" name="__codelineno-10-15" href="#__codelineno-10-15"></a><span class="c1"># - From image file: ScreenCaptured(media_ref={&quot;uri&quot;: &quot;/path/to/image.png&quot;})</span>
<a id="__codelineno-10-16" name="__codelineno-10-16" href="#__codelineno-10-16"></a><span class="c1"># - From video frame: ScreenCaptured(media_ref={&quot;uri&quot;: &quot;/path/video.mkv&quot;, &quot;pts_ns&quot;: 123456})</span>
<a id="__codelineno-10-17" name="__codelineno-10-17" href="#__codelineno-10-17"></a><span class="c1"># - From file URI: ScreenCaptured(media_ref={&quot;uri&quot;: &quot;file:///path/to/video.mp4&quot;, &quot;pts_ns&quot;: 123456})</span>
<a id="__codelineno-10-18" name="__codelineno-10-18" href="#__codelineno-10-18"></a><span class="c1"># - From URL: ScreenCaptured(media_ref={&quot;uri&quot;: &quot;https://example.com/image.png&quot;})</span>
<a id="__codelineno-10-19" name="__codelineno-10-19" href="#__codelineno-10-19"></a><span class="c1"># - From data URI: ScreenCaptured(media_ref={&quot;uri&quot;: &quot;data:image/png;base64,...&quot;})</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="working-with-owamcap">Working with OWAMcap<a class="headerlink" href="#working-with-owamcap" title="Permanent link">&para;</a></h2>
<h3 id="media-handling">Media Handling<a class="headerlink" href="#media-handling" title="Permanent link">&para;</a></h3>
<p>OWAMcap's key advantage is efficient media handling through external media references:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio" /><input id="__tabbed_3_2" name="__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="__tabbed_3_1">Creating ScreenCaptured Messages</label><label for="__tabbed_3_2">Loading and Accessing Frame Data</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>MediaRef supports: <code>URI(data:image/png;base64,... | file:///path | http[s]://...) or file path(/absolute/path | relative/path)</code> for both images and videos.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">owa.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">MESSAGES</span>
<a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a>
<a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="n">ScreenCaptured</span> <span class="o">=</span> <span class="n">MESSAGES</span><span class="p">[</span><span class="s1">&#39;desktop/ScreenCaptured&#39;</span><span class="p">]</span>
<a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a>
<a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="c1"># File paths (absolute/relative) - works for images and videos</span>
<a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;/absolute/path/image.png&quot;</span><span class="p">})</span>
<a id="__codelineno-11-8" name="__codelineno-11-8" href="#__codelineno-11-8"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;relative/video.mkv&quot;</span><span class="p">,</span> <span class="s2">&quot;pts_ns&quot;</span><span class="p">:</span> <span class="mi">123456</span><span class="p">})</span>
<a id="__codelineno-11-9" name="__codelineno-11-9" href="#__codelineno-11-9"></a>
<a id="__codelineno-11-10" name="__codelineno-11-10" href="#__codelineno-11-10"></a><span class="c1"># File URIs - works for images and videos</span>
<a id="__codelineno-11-11" name="__codelineno-11-11" href="#__codelineno-11-11"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;file:///path/to/image.jpg&quot;</span><span class="p">})</span>
<a id="__codelineno-11-12" name="__codelineno-11-12" href="#__codelineno-11-12"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;file:///path/to/video.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;pts_ns&quot;</span><span class="p">:</span> <span class="mi">123456</span><span class="p">})</span>
<a id="__codelineno-11-13" name="__codelineno-11-13" href="#__codelineno-11-13"></a>
<a id="__codelineno-11-14" name="__codelineno-11-14" href="#__codelineno-11-14"></a><span class="c1"># HTTP/HTTPS URLs - works for images and videos</span>
<a id="__codelineno-11-15" name="__codelineno-11-15" href="#__codelineno-11-15"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/image.png&quot;</span><span class="p">})</span>
<a id="__codelineno-11-16" name="__codelineno-11-16" href="#__codelineno-11-16"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;https://example.com/video.mp4&quot;</span><span class="p">,</span> <span class="s2">&quot;pts_ns&quot;</span><span class="p">:</span> <span class="mi">123456</span><span class="p">})</span>
<a id="__codelineno-11-17" name="__codelineno-11-17" href="#__codelineno-11-17"></a>
<a id="__codelineno-11-18" name="__codelineno-11-18" href="#__codelineno-11-18"></a><span class="c1"># Data URIs (embedded base64) - typically for images</span>
<a id="__codelineno-11-19" name="__codelineno-11-19" href="#__codelineno-11-19"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;data:image/png;base64,iVBORw0KGgo...&quot;</span><span class="p">})</span>
<a id="__codelineno-11-20" name="__codelineno-11-20" href="#__codelineno-11-20"></a>
<a id="__codelineno-11-21" name="__codelineno-11-21" href="#__codelineno-11-21"></a><span class="c1"># From raw image array (BGRA format required)</span>
<a id="__codelineno-11-22" name="__codelineno-11-22" href="#__codelineno-11-22"></a><span class="n">bgra_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">1080</span><span class="p">,</span> <span class="mi">1920</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<a id="__codelineno-11-23" name="__codelineno-11-23" href="#__codelineno-11-23"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span><span class="n">frame_arr</span><span class="o">=</span><span class="n">bgra_array</span><span class="p">)</span>
<a id="__codelineno-11-24" name="__codelineno-11-24" href="#__codelineno-11-24"></a><span class="n">screen_msg</span><span class="o">.</span><span class="n">embed_as_data_uri</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;png&quot;</span><span class="p">)</span>  <span class="c1"># Required for serialization</span>
<a id="__codelineno-11-25" name="__codelineno-11-25" href="#__codelineno-11-25"></a><span class="c1"># Now screen_msg.media_ref contains: {&quot;uri&quot;: &quot;data:image/png;base64,...&quot;}</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Lazy Loading</strong>: Frame data is not loaded until explicitly requested, providing enormous advantages when working with external references - you can iterate through thousands of messages without loading actual frame data.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="c1"># IMPORTANT: For MCAP files, resolve relative paths first</span>
<a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="c1"># The OWA recorder saves media paths relative to the MCAP file location</span>
<a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="n">ScreenCaptured</span> <span class="o">=</span> <span class="n">MESSAGES</span><span class="p">[</span><span class="s1">&#39;desktop/ScreenCaptured&#39;</span><span class="p">]</span>
<a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span>
<a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a>    <span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;relative/video.mkv&quot;</span><span class="p">,</span> <span class="s2">&quot;pts_ns&quot;</span><span class="p">:</span> <span class="mi">123456789</span><span class="p">}</span>
<a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="p">)</span>
<a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a>
<a id="__codelineno-12-8" name="__codelineno-12-8" href="#__codelineno-12-8"></a><span class="c1"># Must resolve external paths before loading from MCAP files</span>
<a id="__codelineno-12-9" name="__codelineno-12-9" href="#__codelineno-12-9"></a><span class="n">screen_msg</span><span class="o">.</span><span class="n">resolve_external_path</span><span class="p">(</span><span class="s2">&quot;/path/to/data.mcap&quot;</span><span class="p">)</span>
<a id="__codelineno-12-10" name="__codelineno-12-10" href="#__codelineno-12-10"></a>
<a id="__codelineno-12-11" name="__codelineno-12-11" href="#__codelineno-12-11"></a><span class="c1"># Lazy loading: Frame data is loaded on-demand when these methods are called</span>
<a id="__codelineno-12-12" name="__codelineno-12-12" href="#__codelineno-12-12"></a><span class="n">rgb_array</span> <span class="o">=</span> <span class="n">screen_msg</span><span class="o">.</span><span class="n">to_rgb_array</span><span class="p">()</span>        <span class="c1"># RGB numpy array (most common)</span>
<a id="__codelineno-12-13" name="__codelineno-12-13" href="#__codelineno-12-13"></a><span class="n">pil_image</span> <span class="o">=</span> <span class="n">screen_msg</span><span class="o">.</span><span class="n">to_pil_image</span><span class="p">()</span>        <span class="c1"># PIL Image object</span>
<a id="__codelineno-12-14" name="__codelineno-12-14" href="#__codelineno-12-14"></a><span class="n">bgra_array</span> <span class="o">=</span> <span class="n">screen_msg</span><span class="o">.</span><span class="n">load_frame_array</span><span class="p">()</span>   <span class="c1"># Raw BGRA array (native format)</span>
<a id="__codelineno-12-15" name="__codelineno-12-15" href="#__codelineno-12-15"></a>
<a id="__codelineno-12-16" name="__codelineno-12-16" href="#__codelineno-12-16"></a><span class="c1"># Check if frame data is loaded (lazy loading means it starts as None)</span>
<a id="__codelineno-12-17" name="__codelineno-12-17" href="#__codelineno-12-17"></a><span class="k">if</span> <span class="n">screen_msg</span><span class="o">.</span><span class="n">frame_arr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
<a id="__codelineno-12-18" name="__codelineno-12-18" href="#__codelineno-12-18"></a>    <span class="n">height</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">channels</span> <span class="o">=</span> <span class="n">screen_msg</span><span class="o">.</span><span class="n">frame_arr</span><span class="o">.</span><span class="n">shape</span>
<a id="__codelineno-12-19" name="__codelineno-12-19" href="#__codelineno-12-19"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame: </span><span class="si">{</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">height</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="n">channels</span><span class="si">}</span><span class="s2"> channels&quot;</span><span class="p">)</span>
<a id="__codelineno-12-20" name="__codelineno-12-20" href="#__codelineno-12-20"></a><span class="k">else</span><span class="p">:</span>
<a id="__codelineno-12-21" name="__codelineno-12-21" href="#__codelineno-12-21"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Frame data not loaded - use load_frame_array() first&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="reading-and-writing">Reading and Writing<a class="headerlink" href="#reading-and-writing" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="4:4"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio" /><input id="__tabbed_4_2" name="__tabbed_4" type="radio" /><input id="__tabbed_4_3" name="__tabbed_4" type="radio" /><input id="__tabbed_4_4" name="__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="__tabbed_4_1">Reading</label><label for="__tabbed_4_2">Writing</label><label for="__tabbed_4_3">Advanced</label><label for="__tabbed_4_4">CLI Tools</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcap_owa.highlevel</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMcapReader</span>
<a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a>
<a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;session.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a>    <span class="c1"># File metadata</span>
<a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Topics: </span><span class="si">{</span><span class="n">reader</span><span class="o">.</span><span class="n">topics</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Duration: </span><span class="si">{</span><span class="p">(</span><span class="n">reader</span><span class="o">.</span><span class="n">end_time</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">reader</span><span class="o">.</span><span class="n">start_time</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mf">1e9</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">s&quot;</span><span class="p">)</span>
<a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a>
<a id="__codelineno-13-8" name="__codelineno-13-8" href="#__codelineno-13-8"></a>    <span class="c1"># Lazy loading advantage: Fast iteration without loading frame data</span>
<a id="__codelineno-13-9" name="__codelineno-13-9" href="#__codelineno-13-9"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-13-10" name="__codelineno-13-10" href="#__codelineno-13-10"></a>        <span class="n">screen_data</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span>
<a id="__codelineno-13-11" name="__codelineno-13-11" href="#__codelineno-13-11"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Frame metadata: </span><span class="si">{</span><span class="n">screen_data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> at </span><span class="si">{</span><span class="n">screen_data</span><span class="o">.</span><span class="n">utc_ns</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-13-12" name="__codelineno-13-12" href="#__codelineno-13-12"></a>        <span class="c1"># No frame data loaded yet - extremely fast for large datasets</span>
<a id="__codelineno-13-13" name="__codelineno-13-13" href="#__codelineno-13-13"></a>
<a id="__codelineno-13-14" name="__codelineno-13-14" href="#__codelineno-13-14"></a>        <span class="c1"># Only load frame data when actually needed</span>
<a id="__codelineno-13-15" name="__codelineno-13-15" href="#__codelineno-13-15"></a>        <span class="k">if</span> <span class="n">some_condition</span><span class="p">:</span>  <span class="c1"># e.g., every 10th frame</span>
<a id="__codelineno-13-16" name="__codelineno-13-16" href="#__codelineno-13-16"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">screen_data</span><span class="o">.</span><span class="n">to_rgb_array</span><span class="p">()</span>  <span class="c1"># Now frame is loaded</span>
<a id="__codelineno-13-17" name="__codelineno-13-17" href="#__codelineno-13-17"></a>            <span class="k">break</span>  <span class="c1"># Just show first frame</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcap_owa.highlevel</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMcapWriter</span>
<a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">owa.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">MESSAGES</span>
<a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a>
<a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="n">ScreenCaptured</span> <span class="o">=</span> <span class="n">MESSAGES</span><span class="p">[</span><span class="s1">&#39;desktop/ScreenCaptured&#39;</span><span class="p">]</span>
<a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="n">MouseEvent</span> <span class="o">=</span> <span class="n">MESSAGES</span><span class="p">[</span><span class="s1">&#39;desktop/MouseEvent&#39;</span><span class="p">]</span>
<a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a>
<a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="k">with</span> <span class="n">OWAMcapWriter</span><span class="p">(</span><span class="s2">&quot;output.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a>    <span class="c1"># Write screen capture</span>
<a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a>    <span class="n">screen_msg</span> <span class="o">=</span> <span class="n">ScreenCaptured</span><span class="p">(</span>
<a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a>        <span class="n">utc_ns</span><span class="o">=</span><span class="mi">1234567890</span><span class="p">,</span>
<a id="__codelineno-14-11" name="__codelineno-14-11" href="#__codelineno-14-11"></a>        <span class="n">media_ref</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;uri&quot;</span><span class="p">:</span> <span class="s2">&quot;video.mkv&quot;</span><span class="p">,</span> <span class="s2">&quot;pts_ns&quot;</span><span class="p">:</span> <span class="mi">1234567890</span><span class="p">},</span>
<a id="__codelineno-14-12" name="__codelineno-14-12" href="#__codelineno-14-12"></a>        <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">1920</span><span class="p">,</span> <span class="mi">1080</span><span class="p">)</span>
<a id="__codelineno-14-13" name="__codelineno-14-13" href="#__codelineno-14-13"></a>    <span class="p">)</span>
<a id="__codelineno-14-14" name="__codelineno-14-14" href="#__codelineno-14-14"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">screen_msg</span><span class="p">,</span> <span class="n">topic</span><span class="o">=</span><span class="s2">&quot;screen&quot;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="mi">1234567890</span><span class="p">)</span>
<a id="__codelineno-14-15" name="__codelineno-14-15" href="#__codelineno-14-15"></a>
<a id="__codelineno-14-16" name="__codelineno-14-16" href="#__codelineno-14-16"></a>    <span class="c1"># Write mouse event</span>
<a id="__codelineno-14-17" name="__codelineno-14-17" href="#__codelineno-14-17"></a>    <span class="n">mouse_msg</span> <span class="o">=</span> <span class="n">MouseEvent</span><span class="p">(</span><span class="n">event_type</span><span class="o">=</span><span class="s2">&quot;click&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<a id="__codelineno-14-18" name="__codelineno-14-18" href="#__codelineno-14-18"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">mouse_msg</span><span class="p">,</span> <span class="n">topic</span><span class="o">=</span><span class="s2">&quot;mouse&quot;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="mi">1234567891</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="c1"># Time range filtering</span>
<a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;session.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a>    <span class="n">start_time</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="mi">1_000_000_000</span>  <span class="c1"># Skip first second</span>
<a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a>    <span class="n">end_time</span> <span class="o">=</span> <span class="n">reader</span><span class="o">.</span><span class="n">start_time</span> <span class="o">+</span> <span class="mi">10_000_000_000</span>   <span class="c1"># First 10 seconds</span>
<a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a>
<a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">start_time</span><span class="o">=</span><span class="n">start_time</span><span class="p">,</span> <span class="n">end_time</span><span class="o">=</span><span class="n">end_time</span><span class="p">):</span>
<a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Message in range: </span><span class="si">{</span><span class="n">msg</span><span class="o">.</span><span class="n">topic</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a>
<a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="c1"># Remote files</span>
<a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;https://example.com/data.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-15-12" name="__codelineno-15-12" href="#__codelineno-15-12"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Remote frame: </span><span class="si">{</span><span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="c1"># File information</span>
<a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a>owl<span class="w"> </span>mcap<span class="w"> </span>info<span class="w"> </span>session.mcap
<a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a>
<a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="c1"># List messages</span>
<a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a>owl<span class="w"> </span>mcap<span class="w"> </span>cat<span class="w"> </span>session.mcap<span class="w"> </span>--n<span class="w"> </span><span class="m">10</span><span class="w"> </span>--topics<span class="w"> </span>screen<span class="w"> </span>--topics<span class="w"> </span>mouse
<a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a>
<a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="c1"># Migrate between versions</span>
<a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a>owl<span class="w"> </span>mcap<span class="w"> </span>migrate<span class="w"> </span>run<span class="w"> </span>session.mcap
<a id="__codelineno-16-9" name="__codelineno-16-9" href="#__codelineno-16-9"></a>
<a id="__codelineno-16-10" name="__codelineno-16-10" href="#__codelineno-16-10"></a><span class="c1"># Extract frames</span>
<a id="__codelineno-16-11" name="__codelineno-16-11" href="#__codelineno-16-11"></a>owl<span class="w"> </span>mcap<span class="w"> </span>extract-frames<span class="w"> </span>session.mcap<span class="w"> </span>--output<span class="w"> </span>frames/
</code></pre></div>
</div>
</div>
</div>
<h2 id="storage-performance">Storage &amp; Performance<a class="headerlink" href="#storage-performance" title="Permanent link">&para;</a></h2>
<p>OWAMcap achieves remarkable storage efficiency through external video references and intelligent compression:</p>
<h3 id="compression-benefits">Compression Benefits<a class="headerlink" href="#compression-benefits" title="Permanent link">&para;</a></h3>
<div class="admonition info">
<p class="admonition-title">Understanding the Baseline</p>
<p>Raw screen capture data is enormous: a single 1920Ã—1080 frame in BGRA format is 8.3 MB. At 60 FPS, this means 498 MB per second of recording. OWAMcap's hybrid storage makes this manageable.</p>
</div>
<p>Desktop screen capture at 600 Ã— 800 resolution, 13 s @ 60 Hz:</p>
<table>
<thead>
<tr>
<th>Format</th>
<th style="text-align: right;">Size per Frame</th>
<th style="text-align: right;">Whole Size</th>
<th>Compression Ratio</th>
</tr>
</thead>
<tbody>
<tr>
<td>Raw BGRA</td>
<td style="text-align: right;">1.28 MB</td>
<td style="text-align: right;">1.0 GB</td>
<td>1.0Ã— (baseline)</td>
</tr>
<tr>
<td>PNG</td>
<td style="text-align: right;">436 KB</td>
<td style="text-align: right;">333 MB</td>
<td>3.0Ã—</td>
</tr>
<tr>
<td>JPEG (Quality 85)</td>
<td style="text-align: right;">59 KB</td>
<td style="text-align: right;">46 MB</td>
<td>21.7Ã—</td>
</tr>
<tr>
<td>H.265 (keyframe 0.5s, nvd3d11h265enc)</td>
<td style="text-align: right;">14.5 KB avg</td>
<td style="text-align: right;">11.3 MB</td>
<td>91.7Ã—</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">H.265 Configuration</p>
<p>The H.265 settings shown above (keyframe 0.5s, nvd3d11h265enc) are the same as those used by <a href="../ocap/">ocap</a> for efficient desktop recording.</p>
</div>
<p><strong>Key advantages:</strong></p>
<ul>
<li><strong>Lightweight MCAP:</strong> very fast to parse, transfer, and back up  </li>
<li><strong>Video Compression:</strong> leverages hardware-accelerated codecs for extreme savings  </li>
<li><strong>Selective Loading:</strong> grab only the frames you need without full decompression  </li>
<li><strong>Standard Tools:</strong> preview in any video player and edit with off-the-shelf software  </li>
</ul>
<h2 id="custom-message-types">Custom Message Types<a class="headerlink" href="#custom-message-types" title="Permanent link">&para;</a></h2>
<p>OWAMcap's extensible design allows you to define and register custom message types for domain-specific data while maintaining compatibility with the standard OWAMcap ecosystem.</p>
<h3 id="creating-custom-messages">Creating Custom Messages<a class="headerlink" href="#creating-custom-messages" title="Permanent link">&para;</a></h3>
<p>All custom messages must inherit from <code>OWAMessage</code> and follow the domain/MessageType naming convention:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">owa.core.message</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMessage</span>
<a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">typing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">List</span>
<a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="kn">from</span><span class="w"> </span><span class="nn">pydantic</span><span class="w"> </span><span class="kn">import</span> <span class="n">Field</span><span class="p">,</span> <span class="n">validator</span>
<a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="kn">import</span><span class="w"> </span><span class="nn">time</span>
<a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a>
<a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="k">class</span><span class="w"> </span><span class="nc">TemperatureReading</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;sensors/TemperatureReading&quot;</span>
<a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a>
<a id="__codelineno-17-9" name="__codelineno-17-9" href="#__codelineno-17-9"></a>    <span class="n">temperature</span><span class="p">:</span> <span class="nb">float</span>          <span class="c1"># Temperature in Celsius</span>
<a id="__codelineno-17-10" name="__codelineno-17-10" href="#__codelineno-17-10"></a>    <span class="n">humidity</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">ge</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">le</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>  <span class="c1"># Relative humidity (0-100%)</span>
<a id="__codelineno-17-11" name="__codelineno-17-11" href="#__codelineno-17-11"></a>    <span class="n">location</span><span class="p">:</span> <span class="nb">str</span>              <span class="c1"># Sensor location identifier</span>
<a id="__codelineno-17-12" name="__codelineno-17-12" href="#__codelineno-17-12"></a>    <span class="n">timestamp</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="n">time</span><span class="o">.</span><span class="n">time_ns</span><span class="p">)</span>  <span class="c1"># Unix timestamp in nanoseconds</span>
<a id="__codelineno-17-13" name="__codelineno-17-13" href="#__codelineno-17-13"></a>
<a id="__codelineno-17-14" name="__codelineno-17-14" href="#__codelineno-17-14"></a>    <span class="nd">@validator</span><span class="p">(</span><span class="s1">&#39;temperature&#39;</span><span class="p">)</span>
<a id="__codelineno-17-15" name="__codelineno-17-15" href="#__codelineno-17-15"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_temperature</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<a id="__codelineno-17-16" name="__codelineno-17-16" href="#__codelineno-17-16"></a>        <span class="k">if</span> <span class="n">v</span> <span class="o">&lt;</span> <span class="o">-</span><span class="mf">273.15</span><span class="p">:</span>  <span class="c1"># Absolute zero check</span>
<a id="__codelineno-17-17" name="__codelineno-17-17" href="#__codelineno-17-17"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Temperature cannot be below absolute zero&#39;</span><span class="p">)</span>
<a id="__codelineno-17-18" name="__codelineno-17-18" href="#__codelineno-17-18"></a>        <span class="k">return</span> <span class="n">v</span>
<a id="__codelineno-17-19" name="__codelineno-17-19" href="#__codelineno-17-19"></a>
<a id="__codelineno-17-20" name="__codelineno-17-20" href="#__codelineno-17-20"></a><span class="k">class</span><span class="w"> </span><span class="nc">GameEvent</span><span class="p">(</span><span class="n">OWAMessage</span><span class="p">):</span>
<a id="__codelineno-17-21" name="__codelineno-17-21" href="#__codelineno-17-21"></a>    <span class="n">_type</span> <span class="o">=</span> <span class="s2">&quot;gaming/PlayerAction&quot;</span>
<a id="__codelineno-17-22" name="__codelineno-17-22" href="#__codelineno-17-22"></a>
<a id="__codelineno-17-23" name="__codelineno-17-23" href="#__codelineno-17-23"></a>    <span class="n">action_type</span><span class="p">:</span> <span class="nb">str</span>           <span class="c1"># &quot;move&quot;, &quot;attack&quot;, &quot;interact&quot;</span>
<a id="__codelineno-17-24" name="__codelineno-17-24" href="#__codelineno-17-24"></a>    <span class="n">player_id</span><span class="p">:</span> <span class="nb">str</span>            <span class="c1"># Unique player identifier</span>
<a id="__codelineno-17-25" name="__codelineno-17-25" href="#__codelineno-17-25"></a>    <span class="n">coordinates</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">float</span><span class="p">]</span> <span class="o">=</span> <span class="n">Field</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">min_items</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">max_items</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>  <span class="c1"># [x, y, z] world coordinates</span>
<a id="__codelineno-17-26" name="__codelineno-17-26" href="#__codelineno-17-26"></a>    <span class="n">metadata</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}</span>        <span class="c1"># Additional action-specific data</span>
<a id="__codelineno-17-27" name="__codelineno-17-27" href="#__codelineno-17-27"></a>
<a id="__codelineno-17-28" name="__codelineno-17-28" href="#__codelineno-17-28"></a>    <span class="nd">@validator</span><span class="p">(</span><span class="s1">&#39;action_type&#39;</span><span class="p">)</span>
<a id="__codelineno-17-29" name="__codelineno-17-29" href="#__codelineno-17-29"></a>    <span class="k">def</span><span class="w"> </span><span class="nf">validate_action_type</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
<a id="__codelineno-17-30" name="__codelineno-17-30" href="#__codelineno-17-30"></a>        <span class="n">allowed_actions</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;move&#39;</span><span class="p">,</span> <span class="s1">&#39;attack&#39;</span><span class="p">,</span> <span class="s1">&#39;interact&#39;</span><span class="p">,</span> <span class="s1">&#39;idle&#39;</span><span class="p">}</span>
<a id="__codelineno-17-31" name="__codelineno-17-31" href="#__codelineno-17-31"></a>        <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">allowed_actions</span><span class="p">:</span>
<a id="__codelineno-17-32" name="__codelineno-17-32" href="#__codelineno-17-32"></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;action_type must be one of </span><span class="si">{</span><span class="n">allowed_actions</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<a id="__codelineno-17-33" name="__codelineno-17-33" href="#__codelineno-17-33"></a>        <span class="k">return</span> <span class="n">v</span>
</code></pre></div>
<h3 id="package-registration">Package Registration<a class="headerlink" href="#package-registration" title="Permanent link">&para;</a></h3>
<p>Custom messages are registered through Python entry points in your package's <code>pyproject.toml</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="k">[project.entry-points.</span><span class="s2">&quot;owa.msgs&quot;</span><span class="k">]</span>
<a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="s2">&quot;sensors/TemperatureReading&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_sensors.messages:TemperatureReading&quot;</span>
<a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="s2">&quot;gaming/PlayerAction&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_game.events:GameEvent&quot;</span>
<a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="s2">&quot;custom/MyMessage&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_package.messages:MyMessage&quot;</span>
</code></pre></div>
<p><strong>Important</strong>: The package containing your custom messages must be installed in the same environment where you're using OWAMcap for the entry points to be discovered:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="c1"># Install your custom message package</span>
<a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a>pip<span class="w"> </span>install<span class="w"> </span>my-custom-messages
<a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a>
<a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="c1"># Or install in development mode</span>
<a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a>pip<span class="w"> </span>install<span class="w"> </span>-e<span class="w"> </span>/path/to/my-custom-messages
<a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a>
<a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="c1"># Now custom messages are available in the registry</span>
<a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from owa.core import MESSAGES; print(&#39;sensors/TemperatureReading&#39; in MESSAGES)&quot;</span>
</code></pre></div>
<h3 id="usage-with-owamcap">Usage with OWAMcap<a class="headerlink" href="#usage-with-owamcap" title="Permanent link">&para;</a></h3>
<p>Once registered, custom messages work seamlessly with OWAMcap tools:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcap_owa.highlevel</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMcapWriter</span><span class="p">,</span> <span class="n">OWAMcapReader</span>
<a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="kn">from</span><span class="w"> </span><span class="nn">owa.core</span><span class="w"> </span><span class="kn">import</span> <span class="n">MESSAGES</span>
<a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a>
<a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="c1"># Access your custom message through the registry</span>
<a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="n">TemperatureReading</span> <span class="o">=</span> <span class="n">MESSAGES</span><span class="p">[</span><span class="s1">&#39;sensors/TemperatureReading&#39;</span><span class="p">]</span>
<a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a>
<a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="c1"># Write custom messages to MCAP</span>
<a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="k">with</span> <span class="n">OWAMcapWriter</span><span class="p">(</span><span class="s2">&quot;sensor_data.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">writer</span><span class="p">:</span>
<a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a>    <span class="n">reading</span> <span class="o">=</span> <span class="n">TemperatureReading</span><span class="p">(</span>
<a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a>        <span class="n">temperature</span><span class="o">=</span><span class="mf">23.5</span><span class="p">,</span>
<a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a>        <span class="n">humidity</span><span class="o">=</span><span class="mf">65.2</span><span class="p">,</span>
<a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a>        <span class="n">location</span><span class="o">=</span><span class="s2">&quot;office_desk&quot;</span>
<a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a>    <span class="p">)</span>
<a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a>    <span class="n">writer</span><span class="o">.</span><span class="n">write_message</span><span class="p">(</span><span class="n">reading</span><span class="p">,</span> <span class="n">topic</span><span class="o">=</span><span class="s2">&quot;temperature&quot;</span><span class="p">,</span> <span class="n">timestamp</span><span class="o">=</span><span class="n">reading</span><span class="o">.</span><span class="n">timestamp</span><span class="p">)</span>
<a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a>
<a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="c1"># Read custom messages from MCAP</span>
<a id="__codelineno-20-17" name="__codelineno-20-17" href="#__codelineno-20-17"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;sensor_data.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-20-18" name="__codelineno-20-18" href="#__codelineno-20-18"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;temperature&quot;</span><span class="p">]):</span>
<a id="__codelineno-20-19" name="__codelineno-20-19" href="#__codelineno-20-19"></a>        <span class="n">temp_data</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span>
<a id="__codelineno-20-20" name="__codelineno-20-20" href="#__codelineno-20-20"></a>        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Temperature: </span><span class="si">{</span><span class="n">temp_data</span><span class="o">.</span><span class="n">temperature</span><span class="si">}</span><span class="s2">Â°C at </span><span class="si">{</span><span class="n">temp_data</span><span class="o">.</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</code></pre></div>
<h3 id="best-practices">Best Practices<a class="headerlink" href="#best-practices" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio" /><input id="__tabbed_5_2" name="__tabbed_5" type="radio" /><input id="__tabbed_5_3" name="__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="__tabbed_5_1">Naming Conventions</label><label for="__tabbed_5_2">Schema Design</label><label for="__tabbed_5_3">Package Structure</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li><strong>Domain</strong>: Use descriptive domain names (<code>sensors</code>, <code>gaming</code>, <code>robotics</code>)</li>
<li><strong>MessageType</strong>: Use PascalCase (<code>TemperatureReading</code>, <code>PlayerAction</code>)</li>
<li><strong>Avoid conflicts</strong>: Check existing message types before naming</li>
<li><strong>Be specific</strong>: <code>sensors/TemperatureReading</code> vs generic <code>sensors/Reading</code></li>
</ul>
</div>
<div class="tabbed-block">
<ul>
<li><strong>Use type hints</strong>: Enable automatic JSON schema generation</li>
<li><strong>Leverage pydantic features</strong>: See <a href="https://docs.pydantic.dev/">Pydantic documentation</a> for validation, field constraints, and defaults</li>
<li><strong>Documentation</strong>: Include docstrings for complex message types</li>
</ul>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a>my_custom_package/
<a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a>â”œâ”€â”€ pyproject.toml              # Entry point registration
<a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a>â”œâ”€â”€ my_package/
<a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a>â”‚   â”œâ”€â”€ __init__.py
<a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a>â”‚   â””â”€â”€ messages.py             # Message definitions
<a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a>â””â”€â”€ tests/
<a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a>    â””â”€â”€ test_messages.py        # Message validation tests
</code></pre></div>
</div>
</div>
</div>
<h3 id="cli-integration">CLI Integration<a class="headerlink" href="#cli-integration" title="Permanent link">&para;</a></h3>
<p>Custom messages automatically work with OWA CLI tools:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="c1"># List all available message types (including custom)</span>
<a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a>owl<span class="w"> </span>messages<span class="w"> </span>list
<a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a>
<a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="c1"># View custom message schema</span>
<a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a>owl<span class="w"> </span>messages<span class="w"> </span>show<span class="w"> </span>sensors/TemperatureReading
<a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a>
<a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="c1"># View custom messages in MCAP files</span>
<a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a>owl<span class="w"> </span>mcap<span class="w"> </span>cat<span class="w"> </span>sensor_data.mcap<span class="w"> </span>--topics<span class="w"> </span>temperature
</code></pre></div>
<h2 id="advanced-usage">Advanced Usage<a class="headerlink" href="#advanced-usage" title="Permanent link">&para;</a></h2>
<h3 id="integration-examples">Integration Examples<a class="headerlink" href="#integration-examples" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="__tabbed_6_1" name="__tabbed_6" type="radio" /><input id="__tabbed_6_2" name="__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="__tabbed_6_1">Computer Vision</label><label for="__tabbed_6_2">Behavior Analysis</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="kn">from</span><span class="w"> </span><span class="nn">mcap_owa.highlevel</span><span class="w"> </span><span class="kn">import</span> <span class="n">OWAMcapReader</span>
<a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a>
<a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="k">def</span><span class="w"> </span><span class="nf">detect_objects</span><span class="p">(</span><span class="n">mcap_path</span><span class="p">):</span>
<a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a>    <span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="n">mcap_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a>        <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a>            <span class="n">frame</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">to_rgb_array</span><span class="p">()</span>
<a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a>            <span class="n">results</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">detect</span><span class="p">(</span><span class="n">frame</span><span class="p">)</span>
<a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a>            <span class="k">yield</span> <span class="n">msg</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span> <span class="n">results</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="k">def</span><span class="w"> </span><span class="nf">analyze_user_behavior</span><span class="p">(</span><span class="n">mcap_path</span><span class="p">):</span>
<a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a>    <span class="n">events</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;mouse&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;keyboard&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;screen&quot;</span><span class="p">:</span> <span class="p">[]}</span>
<a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a>    <span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="n">mcap_path</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a>        <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">():</span>
<a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a>            <span class="n">events</span><span class="p">[</span><span class="n">msg</span><span class="o">.</span><span class="n">topic</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
<a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a>                <span class="s2">&quot;timestamp&quot;</span><span class="p">:</span> <span class="n">msg</span><span class="o">.</span><span class="n">timestamp</span><span class="p">,</span>
<a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a>                <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span>
<a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a>            <span class="p">})</span>
<a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a>    <span class="k">return</span> <span class="n">compute_interaction_patterns</span><span class="p">(</span><span class="n">events</span><span class="p">)</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="best-practices_1">Best Practices<a class="headerlink" href="#best-practices_1" title="Permanent link">&para;</a></h3>
<div class="tabbed-set tabbed-alternate" data-tabs="7:3"><input checked="checked" id="__tabbed_7_1" name="__tabbed_7" type="radio" /><input id="__tabbed_7_2" name="__tabbed_7" type="radio" /><input id="__tabbed_7_3" name="__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="__tabbed_7_1">Storage Strategy</label><label for="__tabbed_7_2">Performance</label><label for="__tabbed_7_3">File Organization</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Decision Tree: Choose Your Storage Approach</strong></p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a>Recording Length?
<a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a>â”œâ”€ &lt; 30 seconds
<a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a>â”‚  â””â”€ Use embedded data URIs (self-contained)
<a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a>â””â”€ &gt; 30 seconds
<a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a>   â””â”€ File Size Priority?
<a id="__codelineno-25-6" name="__codelineno-25-6" href="#__codelineno-25-6"></a>      â”œâ”€ Minimize MCAP size
<a id="__codelineno-25-7" name="__codelineno-25-7" href="#__codelineno-25-7"></a>      â”‚  â””â”€ Use external video (.mkv)
<a id="__codelineno-25-8" name="__codelineno-25-8" href="#__codelineno-25-8"></a>      â””â”€ Maximize quality
<a id="__codelineno-25-9" name="__codelineno-25-9" href="#__codelineno-25-9"></a>         â””â”€ Use external images (.png)
</code></pre></div>
<table>
<thead>
<tr>
<th>Use Case</th>
<th>Strategy</th>
<th>Benefits</th>
<th>Trade-offs</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Long recordings</strong></td>
<td>External video</td>
<td>Minimal MCAP size, efficient</td>
<td>Requires external files</td>
</tr>
<tr>
<td><strong>Short sessions</strong></td>
<td>Embedded data</td>
<td>Self-contained</td>
<td>Larger MCAP files</td>
</tr>
<tr>
<td><strong>High-quality</strong></td>
<td>External images</td>
<td>Lossless compression</td>
<td>Many files to manage</td>
</tr>
<tr>
<td><strong>Remote datasets</strong></td>
<td>Video + URLs</td>
<td>Bandwidth efficient</td>
<td>Network dependency</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="c1"># âœ… Good: Filter topics early</span>
<a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="k">with</span> <span class="n">OWAMcapReader</span><span class="p">(</span><span class="s2">&quot;file.mcap&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">reader</span><span class="p">:</span>
<a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a>    <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a>        <span class="n">process_frame</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="p">)</span>
<a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a>
<a id="__codelineno-26-6" name="__codelineno-26-6" href="#__codelineno-26-6"></a><span class="c1"># âœ… Good: Lazy loading</span>
<a id="__codelineno-26-7" name="__codelineno-26-7" href="#__codelineno-26-7"></a><span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-26-8" name="__codelineno-26-8" href="#__codelineno-26-8"></a>    <span class="k">if</span> <span class="n">should_process_frame</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
<a id="__codelineno-26-9" name="__codelineno-26-9" href="#__codelineno-26-9"></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">load_frame_array</span><span class="p">()</span>  <span class="c1"># Only when needed</span>
<a id="__codelineno-26-10" name="__codelineno-26-10" href="#__codelineno-26-10"></a>
<a id="__codelineno-26-11" name="__codelineno-26-11" href="#__codelineno-26-11"></a><span class="c1"># âŒ Avoid: Loading all frames</span>
<a id="__codelineno-26-12" name="__codelineno-26-12" href="#__codelineno-26-12"></a><span class="n">frames</span> <span class="o">=</span> <span class="p">[</span><span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">load_frame_array</span><span class="p">()</span> <span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">()]</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p><strong>Recommended structure:</strong>
<div class="highlight"><pre><span></span><code><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a>/data/
<a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a>â”œâ”€â”€ mcaps/                          # Raw MCAP recordings
<a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a>â”‚   â”œâ”€â”€ session_001.mcap
<a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a>â”‚   â”œâ”€â”€ session_001.mkv             # External video files
<a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a>â”‚   â””â”€â”€ session_002.mcap
<a id="__codelineno-27-6" name="__codelineno-27-6" href="#__codelineno-27-6"></a>â”œâ”€â”€ event-dataset/                  # Stage 1: Event Dataset
<a id="__codelineno-27-7" name="__codelineno-27-7" href="#__codelineno-27-7"></a>â”‚   â”œâ”€â”€ train/
<a id="__codelineno-27-8" name="__codelineno-27-8" href="#__codelineno-27-8"></a>â”‚   â””â”€â”€ test/
<a id="__codelineno-27-9" name="__codelineno-27-9" href="#__codelineno-27-9"></a>â””â”€â”€ binned-dataset/                 # Stage 2: Binned Dataset
<a id="__codelineno-27-10" name="__codelineno-27-10" href="#__codelineno-27-10"></a>    â”œâ”€â”€ train/
<a id="__codelineno-27-11" name="__codelineno-27-11" href="#__codelineno-27-11"></a>    â””â”€â”€ test/
</code></pre></div></p>
<p>See <a href="../owa_data_pipeline/">OWA Data Pipeline</a> for complete pipeline details.</p>
</div>
</div>
</div>
<h2 id="migration-troubleshooting">Migration &amp; Troubleshooting<a class="headerlink" href="#migration-troubleshooting" title="Permanent link">&para;</a></h2>
<h3 id="file-migration">File Migration<a class="headerlink" href="#file-migration" title="Permanent link">&para;</a></h3>
<p>The <code>owl mcap migrate</code> command handles version upgrades automatically:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="c1"># Migrate to latest version</span>
<a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a>owl<span class="w"> </span>mcap<span class="w"> </span>migrate<span class="w"> </span>run<span class="w"> </span>old_file.mcap
<a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a>
<a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="c1"># Migrate multiple files</span>
<a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a>owl<span class="w"> </span>mcap<span class="w"> </span>migrate<span class="w"> </span>run<span class="w"> </span>file1.mcap<span class="w"> </span>file2.mcap
<a id="__codelineno-28-6" name="__codelineno-28-6" href="#__codelineno-28-6"></a>
<a id="__codelineno-28-7" name="__codelineno-28-7" href="#__codelineno-28-7"></a><span class="c1"># Dry run to see what would be migrated</span>
<a id="__codelineno-28-8" name="__codelineno-28-8" href="#__codelineno-28-8"></a>owl<span class="w"> </span>mcap<span class="w"> </span>migrate<span class="w"> </span>run<span class="w"> </span>old_file.mcap<span class="w"> </span>--dry-run
</code></pre></div>
<h3 id="common-issues">Common Issues<a class="headerlink" href="#common-issues" title="Permanent link">&para;</a></h3>
<div class="admonition warning">
<p class="admonition-title">File Not Found Errors</p>
<p>When video files are missing:
<div class="highlight"><pre><span></span><code><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="c1"># Resolve relative paths</span>
<a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="n">screen_msg</span><span class="o">.</span><span class="n">resolve_external_path</span><span class="p">(</span><span class="s2">&quot;/path/to/mcap/file.mcap&quot;</span><span class="p">)</span>
<a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="c1"># Check if external media exists</span>
<a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="n">screen_msg</span><span class="o">.</span><span class="n">media_ref</span><span class="o">.</span><span class="n">validate_uri</span><span class="p">()</span>
</code></pre></div></p>
</div>
<div class="admonition warning">
<p class="admonition-title">Memory Usage</p>
<p>Large datasets can consume memory:
<div class="highlight"><pre><span></span><code><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="c1"># Use lazy loading instead of loading all frames</span>
<a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="k">for</span> <span class="n">msg</span> <span class="ow">in</span> <span class="n">reader</span><span class="o">.</span><span class="n">iter_messages</span><span class="p">(</span><span class="n">topics</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;screen&quot;</span><span class="p">]):</span>
<a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a>    <span class="k">if</span> <span class="n">should_process_frame</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">timestamp</span><span class="p">):</span>
<a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a>        <span class="n">frame</span> <span class="o">=</span> <span class="n">msg</span><span class="o">.</span><span class="n">decoded</span><span class="o">.</span><span class="n">load_frame_array</span><span class="p">()</span>  <span class="c1"># Only when needed</span>
</code></pre></div></p>
</div>
<h2 id="technical-reference">Technical Reference<a class="headerlink" href="#technical-reference" title="Permanent link">&para;</a></h2>
<p>For detailed technical specifications, see:</p>
<ul>
<li><strong><a href="../../oeps/oep-0006.md">OEP-0006: OWAMcap Profile Specification</a></strong> - Authoritative format specification</li>
<li><strong><a href="https://mcap.dev/">MCAP Format</a></strong> - Base container format documentation</li>
<li><strong>Message Registry</strong> - See <code>projects/owa-core/owa/core/messages.py</code> for implementation</li>
</ul>
<h3 id="quick-reference">Quick Reference<a class="headerlink" href="#quick-reference" title="Permanent link">&para;</a></h3>
<p><strong>OWAMcap Definition:</strong></p>
<ul>
<li>Base format: Standard MCAP container</li>
<li>Profile: <code>owa</code> designation in MCAP metadata</li>
<li>Schema encoding: JSON Schema</li>
<li>Message interface: All messages implement <code>BaseMessage</code></li>
</ul>
<p><strong>Standard Topics:</strong></p>
<ul>
<li><code>screen</code> â†’ <code>desktop/ScreenCaptured</code></li>
<li><code>mouse</code> â†’ <code>desktop/MouseEvent</code></li>
<li><code>keyboard</code> â†’ <code>desktop/KeyboardEvent</code></li>
<li><code>keyboard/state</code> â†’ <code>desktop/KeyboardState</code></li>
<li><code>mouse/state</code> â†’ <code>desktop/MouseState</code></li>
<li><code>window</code> â†’ <code>desktop/WindowInfo</code></li>
</ul>
<h2 id="next-steps">Next Steps<a class="headerlink" href="#next-steps" title="Permanent link">&para;</a></h2>
<ul>
<li><strong><a href="../how_to_explorer_and_edit/">Explore and Edit</a></strong>: Learn to work with OWAMcap files</li>
<li><strong><a href="../owa_data_pipeline/">Data Pipeline</a></strong>: Process OWAMcap for ML training</li>
<li><strong><a href="../viewer/">Viewer</a></strong>: Visualize OWAMcap data interactively</li>
<li><strong><a href="../comparison_with_lerobot/">Comparison with LeRobot</a></strong>: See how OWAMcap differs from other formats</li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="June 27, 2025 17:51:13 UTC">June 27, 2025 17:51:13</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.sections", "navigation.top", "search.suggest", "search.highlight", "content.tabs.link", "content.code.annotation", "content.code.copy"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
      
        <script src="../../termynal.js"></script>
      
    
  </body>
</html>